# GameScout Deployment Guide

## Overview
This guide walks through deploying GameScout to production:
- **Backend**: Render (Flask API + PostgreSQL)
- **Frontend**: Netlify (React SPA)

---

## Prerequisites

1. **GitHub Repository**: Code pushed to `git@github.com:gpfing/GameScoutGamingDB.git`
2. **RAWG API Key**: Get free API key from [https://rawg.io/apidocs](https://rawg.io/apidocs)
3. **Accounts**:
   - Render account: [https://render.com](https://render.com)
   - Netlify account: [https://netlify.com](https://netlify.com)

---

## Part 1: Deploy Backend to Render

### Option A: Using render.yaml (Blueprint - Recommended)

1. **Login to Render**: [https://dashboard.render.com](https://dashboard.render.com)

2. **Create New Blueprint**:
   - Click "New +"
   - Select "Blueprint"
   - Connect your GitHub repository
   - Render will detect `render.yaml` and create:
     - PostgreSQL database (`gamescout-db`)
     - Web service (`gamescout-api`)

3. **Configure Environment Variables**:
   After blueprint deployment, go to `gamescout-api` service → Environment:
   - `RAWG_API_KEY`: Your RAWG API key
   - `FRONTEND_URL`: (Leave empty for now, will add after frontend deployment)
   - `SECRET_KEY`: Auto-generated ✓
   - `JWT_SECRET_KEY`: Auto-generated ✓
   - `DATABASE_URL`: Auto-connected to database ✓

4. **Deploy**: Render will automatically build and deploy your API

### Option B: Manual Setup

1. **Create PostgreSQL Database**:
   - New + → PostgreSQL
   - Name: `gamescout-db`
   - Database: `gamescout`
   - Region: Oregon (or closest to you)
   - Plan: Free
   - Click "Create Database"
   - Copy the "Internal Database URL"

2. **Create Web Service**:
   - New + → Web Service
   - Connect your GitHub repository
   - Settings:
     - **Name**: `gamescout-api`
     - **Region**: Same as database
     - **Branch**: `main`
     - **Root Directory**: `backend`
     - **Runtime**: Python 3
     - **Build Command**: `./build.sh`
     - **Start Command**: `gunicorn app:app`
     - **Plan**: Free

3. **Add Environment Variables**:
   - `DATABASE_URL`: Paste the Internal Database URL
   - `SECRET_KEY`: Generate random string (32+ chars)
   - `JWT_SECRET_KEY`: Generate random string (32+ chars)
   - `RAWG_API_KEY`: Your RAWG API key
   - `FRONTEND_URL`: (Add after frontend deployment)
   - `PYTHON_VERSION`: `3.12.0`

4. **Deploy**: Click "Create Web Service"

### Verify Backend Deployment

Once deployed, test your API:
- URL: `https://gamescout-api.onrender.com` (or your assigned URL)
- Health check: `https://gamescout-api.onrender.com/api/health`
- Should return: `{"status": "healthy", "message": "GameScout API is running"}`

**Important**: Copy your backend URL for frontend configuration!

---

## Part 2: Deploy Frontend to Netlify

### Using Netlify Dashboard

1. **Login to Netlify**: [https://app.netlify.com](https://app.netlify.com)

2. **Import from Git**:
   - Click "Add new site" → "Import an existing project"
   - Choose "GitHub"
   - Select your `GameScoutGamingDB` repository
   - Configure settings:
     - **Branch**: `main`
     - **Base directory**: `frontend`
     - **Build command**: `npm install && npm run build`
     - **Publish directory**: `frontend/dist`

3. **Add Environment Variable**:
   - Before deploying, click "Show advanced"
   - Add new variable:
     - **Key**: `VITE_API_URL`
     - **Value**: `https://gamescout-api.onrender.com/api` (your backend URL)

4. **Deploy**: Click "Deploy site"

5. **Custom Domain** (Optional):
   - Site settings → Domain management
   - Change site name or add custom domain

### Verify Frontend Deployment

- Your site will be at: `https://your-site-name.netlify.app`
- Test login/signup functionality
- Check browser console for API connection errors

---

## Part 3: Connect Frontend & Backend

### Update Backend CORS

1. **Go to Render Dashboard** → `gamescout-api` service

2. **Add Environment Variable**:
   - `FRONTEND_URL`: `https://your-site-name.netlify.app` (no trailing slash)

3. **Redeploy**: Render will automatically redeploy with new CORS settings

### Test Full Integration

1. Visit your Netlify site
2. Sign up for a new account
3. Browse games and add to wishlist
4. Check that all features work:
   - Authentication
   - Game search/filtering
   - Wishlist operations
   - Recommendations

---

## Environment Variables Summary

### Backend (Render)
```env
DATABASE_URL=postgresql://...  (auto-connected)
SECRET_KEY=<auto-generated>
JWT_SECRET_KEY=<auto-generated>
RAWG_API_KEY=<your-key>
FRONTEND_URL=https://your-site.netlify.app
PYTHON_VERSION=3.12.0
```

### Frontend (Netlify)
```env
VITE_API_URL=https://gamescout-api.onrender.com/api
```

---

## Troubleshooting

### Backend Issues

**Build fails**:
- Check build logs in Render dashboard
- Verify `build.sh` is executable
- Check Python version compatibility

**Database connection errors**:
- Verify `DATABASE_URL` is set correctly
- Check database is running (Render dashboard)
- Ensure database and web service are in same region

**CORS errors**:
- Verify `FRONTEND_URL` matches exact Netlify URL (no trailing slash)
- Check browser console for specific CORS error
- Redeploy after changing environment variables

### Frontend Issues

**API connection fails**:
- Verify `VITE_API_URL` is correct
- Check backend is deployed and healthy
- Look for CORS errors in browser console

**Build fails**:
- Check build logs in Netlify
- Verify Node version (should be 20)
- Check `package.json` scripts

**Routes not working (404)**:
- Verify `_redirects` file exists in `frontend/public/`
- Check `netlify.toml` redirect rules

### General Tips

- **Cold starts**: Free Render instances spin down after inactivity. First request may take 30-60 seconds.
- **Logs**: Check Render logs for backend errors, browser console for frontend errors
- **Database**: Free PostgreSQL on Render has 90-day expiration. Upgrade for persistence.
- **Testing locally**: Use `.env` files (not `.env.example`) with your actual values

---

## Local Development After Deployment

Keep developing locally with:

**Backend** (`backend/.env`):
```env
DATABASE_URL=sqlite:///gamescout.db
FRONTEND_URL=http://localhost:5173
```

**Frontend** (`frontend/.env`):
```env
VITE_API_URL=http://localhost:5000/api
```

---

## Updating Deployed Apps

### Backend Updates
```bash
git add .
git commit -m "Update backend"
git push origin main
```
Render auto-deploys on push to main branch.

### Frontend Updates
```bash
git add .
git commit -m "Update frontend"
git push origin main
```
Netlify auto-deploys on push to main branch.

---

## Production Checklist

- [ ] Backend deployed to Render
- [ ] PostgreSQL database created and connected
- [ ] Backend health check returns 200
- [ ] Frontend deployed to Netlify
- [ ] Environment variables configured (both platforms)
- [ ] CORS configured with correct frontend URL
- [ ] Can sign up/login
- [ ] Can search and filter games
- [ ] Can add/remove from wishlist
- [ ] Recommendations work
- [ ] No console errors

---

## Support Resources

- **Render Docs**: [https://render.com/docs](https://render.com/docs)
- **Netlify Docs**: [https://docs.netlify.com](https://docs.netlify.com)
- **RAWG API Docs**: [https://api.rawg.io/docs](https://api.rawg.io/docs)

---

## Next Steps

After successful deployment:
1. Monitor application performance
2. Set up custom domain (optional)
3. Configure monitoring/alerting
4. Plan for database backups (Render paid tier)
5. Implement rate limiting for production
6. Add Google Analytics (optional)
